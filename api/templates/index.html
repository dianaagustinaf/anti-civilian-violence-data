<!DOCTYPE html>
<html lang="en-us">
​
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>Anti-Civilian Violence Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="../../assets/css/style.css">
    
    <!-- Leaflet JavaScript code -->
    <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js"
    integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q=="
    crossorigin=""></script>

    
    <!-- Marker cluster JavaScript code -->
    <script type="text/javascript" src="https://unpkg.com/leaflet.markercluster@1.0.3/dist/leaflet.markercluster.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css"
    integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
    crossorigin=""/>
    
    <!-- Marker cluster CSS -->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.css">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.Default.css">
  </head>
​
<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
        <a class="navbar-brand text-light-green" href="index.html">Anti-Civilian Violence</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" 
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav  me-auto mb-2 mb-lg-0">
                <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Plots
                </a>
                <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                    <li><a class="dropdown-item" href="visualizations/1_viz.html">Ukraine</a></li>
                    <li><a class="dropdown-item" href="visualizations/2_viz.html">Regional Data</a></li>
                    <li><a class="dropdown-item" href="visualizations/3_viz.html">Global Data</a></li>
                </ul>
                </li>

                <li class="nav-item">
                <a class="nav-link active" href="comparison.html">Comparison</a>
                </li>
                <li class="nav-item">
                <a class="nav-link active" href="data.html">Data</a>
                </li>

            </ul>
            </div>
        </div>
    </nav>

    <section>
        <br>
    </section>


    <!-- SUMARY -->
    <section>
        <div class="container">
        <div class="row">
            <div class="col-lg-6">

            <h1 class="dark:bg-primary dark:text-white">Project Summary</h1>
            <br>
            <h5 class="text-light-green">Anti-Civilian Violence Data Analysis</h5>
            <br>
            <p>{{ txt }}</p>
            <p> 
                As a result of international news outlets highlighting violence against civilians 
                in the Russian invasion of Ukraine we want to visualise the data gathered by ACLED 
                and see what patterns we could interpret. We are intrigued to see if there was a 
                distinction between the frequency of occurrence and fatality count pre-Russian invasion and post. 
                Also to identify any significant changes since the beginning of the invasion and the progression 
                of the conflict. 

                Finally, we will make a comparison with the rest of Europe and globally to draw a conclusion; 
                is this type of violence an exceptional case?
                <!-- 
                <a class="text-light-green" target="_blank"
                href="https://www.link">
                GREEN LINK </a> 
                 -->
                These are the results found in the analysis. 
            </p>
            </div>

            <div class="col-lg-6">
                
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                          <div class="well">
                            <h3>Ukraine: Violence Against Civilians Events (by location):</h5>
                            <select id="ukraine_data" onchange="optionChanged(this.value)"></select>
                          </div>
                          <div class="panel panel-primary">
                            <div class="panel-heading">
                              <h5 class="panel-title">Info</h3>
                            </div>
                            <div id="location-metadata" class="panel-body"></div>
                          </div>
                    <div class="row">

                        <h1 class="dark:bg-primary dark:text-white">Visualisations</h1>

                        <div class="col-md-12">
                            <h5>Ukraine: Violence Against Civilians Map Plot</h5>
                                <div id="my_map" style="width: 600px; height: 400px"></div>/>
                            <h5>Ukraine: Fatality Count by Sub-Event Type</h5>
                            <a href="visualizations/2_viz.html"></a>
                                <div id="bar" style="width: 600px; height: 400px"></div>
                            </a>
                        </div>
                        <div class="col-md-6">
                            <a href="visualizations/3_viz.html">
                                <img width="100%" src="../../assets/images/heat.JPG" alt="" />
                            </a>
                            <a href="visualizations/4_viz.html">
                                <img width="100%" src="../../assets/images/line.JPG" alt="" />
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </section>

    ​
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  <!----------------------------->
  <!----------------------------->  
  <!-- Our Maps -->
  <!----------------------------->
  <!----------------------------->
    <!-- <script type="text/javascript" src="../../static/js/ukriane_map.js"></script> -->
  <script>
    var data = {{gj |safe}}
    // create map
    var myMap = L.map("my_map", {
    center: [49.05, 33.22],
    zoom: 6
  });

  // Add tile layer 
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
 }).addTo(myMap);

// loop over geojson to find radius size 
// for(var i=0; i < data.feature.length; i++) {
//   var radius = Math.sqrt(data.feature[i].properties.fatalities)*10,
// };

var markers = {
    opacity: 1,
    fillOpacity: 1,
    fillColor: "red",
    color: "red",
    // fatality count 
    // radius: radius
    radius: 3,
    stroke: true,
    weight: 0.5
};

// shan add layer here = each year or sub event type?

L.geoJSON(data, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, markers);
    },
    onEachFeature: function(feature, layer) {
        layer.bindPopup("Location: " + feature.properties.location + "<br> Event Date: " + feature.properties.event_data + "<br>Sub-Event Type: " + feature.properties.sub_event_type + "<br>Fatalities: " + feature.properties.fatalities)
        // layer.on({
        // mouseover: highlightFeature,
        // mouseout: resetHighlight,
        // click: zoomToFeature
        // });
    }
    }).addTo(myMap);

  </script>
  <!----------------------------->
  <!----------------------------->
  <!-- Panel JS -->
  <!----------------------------->
  <!----------------------------->
  <script>
  // Funnel in Ukraine data
    function ukraine_data() {
        var ukraine = d3.select("#ukraine_data");
        // I don't think I am using the geojson correctly 
        // go over this in class 
        var data = {{gj |safe}}
            // change on locations
            var locations = data.feature.properties.location;
            
            locations.forEach((location) => {
                ukraine.append("option").text(location).property("value", location);
            });
            // these are the locations
            var firstLocation = locations[0];
            chooseLocation(first_location);
        }

    ukraine_data();

    function optionChanged(location) {
        chooseLocation(location);
    }

    function chooseLocation(location){
        (data) => {
        var metadata = data.metadata;
        var resultsarray = metadata.filter(locationobj => location == location);
        var results = resultsarray[0]
        // link to html panel to visulise data 
        var panel = d3.select("#location-metadata");
        panel.html("");
        Object.entries(results).forEach(([key, value]) => {
            panel.append("h6").text(`${key.toUpperCase()}:${value}`);
        });
    };
    }
</script>
<!----------------------------->
<!----------------------------->
<!-- Plots JS -->
<!----------------------------->
<!----------------------------->
<script>
    // how to funnel in geojson data to use for plots? Same issue as panel 
    function plotCharts() {

    
    // ids, labels, values

    // data 
    varData = [
        {
            x: data.feature.properties.event_date,
            y: data.features.properties.fatalities,
            text: ,
            type: "bar"
        }
    ];

    var barLayout = {title: "Fatalities over time: 2018-2022"};
    // plot
    Plotly.newPlot("bar", barData, barLayout);
    };

</script>
</body>
</html>